<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Linear regression, model selection, and prediction in R | Introduction to Environmental Data Science</title>
  <meta name="description" content="“ENVST 325: Environmental Data Science, Hamilton College”" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Linear regression, model selection, and prediction in R | Introduction to Environmental Data Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="“ENVST 325: Environmental Data Science, Hamilton College”" />
  <meta name="github-repo" content="kroppheather/Intro_EnvDataSci" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Linear regression, model selection, and prediction in R | Introduction to Environmental Data Science" />
  
  <meta name="twitter:description" content="“ENVST 325: Environmental Data Science, Hamilton College”" />
  

<meta name="author" content="Heather Kropp" />


<meta name="date" content="2024-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#course-learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Course Learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#license"><i class="fa fa-check"></i><b>1.2</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html"><i class="fa fa-check"></i><b>2</b> Introduction to R Statistical Software and Git</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#new-functions-syntax"><i class="fa fa-check"></i><b>2.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#first-some-terms"><i class="fa fa-check"></i><b>2.3</b> First some terms:</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#setting-up-a-repository-in-github"><i class="fa fa-check"></i><b>2.4</b> Setting up a Repository in GitHub</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#create-a-repository"><i class="fa fa-check"></i><b>2.4.1</b> <em>Create a repository</em></a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#create-a-personal-token-for-rstudio-cloud"><i class="fa fa-check"></i><b>2.4.2</b> <em>Create a personal token for Rstudio Cloud</em></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#start-a-project-with-version-control-in-rstudio-cloud"><i class="fa fa-check"></i><b>2.5</b> Start a project with version control in Rstudio Cloud</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#start-a-project-linked-with-a-repository"><i class="fa fa-check"></i><b>2.5.1</b> <em>Start a project linked with a repository</em></a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#rstudio-interface"><i class="fa fa-check"></i><b>2.5.2</b> <em>Rstudio interface</em></a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#version-control"><i class="fa fa-check"></i><b>2.5.3</b> <em>Version control</em></a></li>
<li class="chapter" data-level="2.5.4" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#commit-your-first-changes-to-github"><i class="fa fa-check"></i><b>2.5.4</b> <em>Commit your first changes to GitHub</em></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#introrefresher-on-r"><i class="fa fa-check"></i><b>2.6</b> Intro/Refresher on R</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#variables"><i class="fa fa-check"></i><b>2.7</b> Variables</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#vectors"><i class="fa fa-check"></i><b>2.7.1</b> <em>Vectors</em></a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#data-frames"><i class="fa fa-check"></i><b>2.7.2</b> <em>Data frames</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html"><i class="fa fa-check"></i><b>3</b> The data deluge: data wrangling in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#learning-objectives-1"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#new-functions-syntax-1"><i class="fa fa-check"></i><b>3.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="3.3" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#the-problem"><i class="fa fa-check"></i><b>3.3</b> The problem:</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#flooding-and-natural-disasters"><i class="fa fa-check"></i><b>3.3.1</b> <em>Flooding and natural disasters</em></a></li>
<li class="chapter" data-level="3.3.2" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#the-data-flood-stage-stream-guage-height"><i class="fa fa-check"></i><b>3.3.2</b> <em>The data: flood stage &amp; stream guage height</em></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#the-approach-packages-in-r"><i class="fa fa-check"></i><b>3.4</b> The approach: packages in R</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#installing-packages"><i class="fa fa-check"></i><b>3.4.1</b> <em>Installing packages</em></a></li>
<li class="chapter" data-level="3.4.2" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#loading-packages"><i class="fa fa-check"></i><b>3.4.2</b> <em>Loading packages</em></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#the-approach-data-wrangling"><i class="fa fa-check"></i><b>3.5</b> The approach: data wrangling</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#reading-in-data"><i class="fa fa-check"></i><b>3.5.1</b> <em>Reading in data</em></a></li>
<li class="chapter" data-level="3.5.2" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#parsing-datetime"><i class="fa fa-check"></i><b>3.5.2</b> <em>Parsing date/time</em></a></li>
<li class="chapter" data-level="3.5.3" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#extracting-information-from-dates"><i class="fa fa-check"></i><b>3.5.3</b> <em>Extracting information from dates</em></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#basic-subsetting"><i class="fa fa-check"></i><b>3.6</b> <em>Basic subsetting</em></a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#basic-plotting"><i class="fa fa-check"></i><b>3.6.1</b> <em>Basic plotting</em></a></li>
<li class="chapter" data-level="3.6.2" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#joining-data-tables-with-a-common-feature"><i class="fa fa-check"></i><b>3.6.2</b> <em>Joining data tables with a common feature</em></a></li>
<li class="chapter" data-level="3.6.3" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#aggregating-data-chaining-functions"><i class="fa fa-check"></i><b>3.6.3</b> <em>Aggregating data &amp; chaining functions</em></a></li>
<li class="chapter" data-level="3.6.4" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#filtering-data"><i class="fa fa-check"></i><b>3.6.4</b> <em>Filtering data</em></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#citations"><i class="fa fa-check"></i><b>3.7</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html"><i class="fa fa-check"></i><b>4</b> Data visualization in R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#learning-objectives-2"><i class="fa fa-check"></i><b>4.1</b> Learning objectives</a></li>
<li class="chapter" data-level="4.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#new-functions-syntax-2"><i class="fa fa-check"></i><b>4.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="4.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#the-problem-1"><i class="fa fa-check"></i><b>4.3</b> The problem:</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#communicating-about-climate-change"><i class="fa fa-check"></i><b>4.3.1</b> <em>Communicating about climate change</em></a></li>
<li class="chapter" data-level="4.3.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#the-data"><i class="fa fa-check"></i><b>4.3.2</b> <em>The data</em></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#fundamentals-of-plotting-data"><i class="fa fa-check"></i><b>4.4</b> Fundamentals of plotting data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#representation-of-data"><i class="fa fa-check"></i><b>4.4.1</b> <em>1. Representation of data</em></a></li>
<li class="chapter" data-level="4.4.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#layout"><i class="fa fa-check"></i><b>4.4.2</b> <em>2. Layout</em></a></li>
<li class="chapter" data-level="4.4.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#encoding"><i class="fa fa-check"></i><b>4.4.3</b> <em>3. Encoding</em></a></li>
<li class="chapter" data-level="4.4.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#simplicity"><i class="fa fa-check"></i><b>4.4.4</b> <em>4. Simplicity</em></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#plotting-data-in-base-r"><i class="fa fa-check"></i><b>4.5</b> Plotting data in base R</a></li>
<li class="chapter" data-level="4.6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#plotting-in-ggplot2"><i class="fa fa-check"></i><b>4.6</b> Plotting in ggplot2</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#intro-to-ggplot"><i class="fa fa-check"></i><b>4.6.1</b> <em>Intro to ggplot</em></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#changing-colors"><i class="fa fa-check"></i><b>4.6.2</b> <em>Changing colors</em></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#exploring-different-visualizations-in-ggplot2"><i class="fa fa-check"></i><b>4.6.3</b> Exploring different visualizations in ggplot2</a></li>
<li class="chapter" data-level="4.6.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#violin-and-box-plots"><i class="fa fa-check"></i><b>4.6.4</b> <em>Violin and box plots</em></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#area-and-ribbon-plots"><i class="fa fa-check"></i><b>4.6.5</b> <em>Area and ribbon plots</em></a></li>
<li class="chapter" data-level="4.6.6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#labels"><i class="fa fa-check"></i><b>4.6.6</b> <em>Labels</em></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#conclusions"><i class="fa fa-check"></i><b>4.7</b> Conclusions</a></li>
<li class="chapter" data-level="4.8" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#citations-1"><i class="fa fa-check"></i><b>4.8</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><i class="fa fa-check"></i><b>5</b> When it rains, it pours. An introduction to data cleaning.</a>
<ul>
<li class="chapter" data-level="5.1" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#learning-objectives-3"><i class="fa fa-check"></i><b>5.1</b> Learning objectives</a></li>
<li class="chapter" data-level="5.2" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#new-functions-syntax-3"><i class="fa fa-check"></i><b>5.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="5.3" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#the-problem-ensuring-reliable-data"><i class="fa fa-check"></i><b>5.3</b> The problem: ensuring reliable data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#sensors-for-weather-and-microclimate"><i class="fa fa-check"></i><b>5.3.1</b> <em>Sensors for weather and microclimate</em></a></li>
<li class="chapter" data-level="5.3.2" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#problematic-data"><i class="fa fa-check"></i><b>5.3.2</b> <em>Problematic data</em></a></li>
<li class="chapter" data-level="5.3.3" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#the-data-1"><i class="fa fa-check"></i><b>5.3.3</b> <em>The data</em></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#cleaning-data"><i class="fa fa-check"></i><b>5.4</b> Cleaning data</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#removing-unreliable-data"><i class="fa fa-check"></i><b>5.4.1</b> <em>Removing unreliable data</em></a></li>
<li class="chapter" data-level="5.4.2" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#creating-flags"><i class="fa fa-check"></i><b>5.4.2</b> <em>Creating flags</em></a></li>
<li class="chapter" data-level="5.4.3" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#creating-functions-to-check-data"><i class="fa fa-check"></i><b>5.4.3</b> <em>Creating functions to check data</em></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#conclusion"><i class="fa fa-check"></i><b>5.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html"><i class="fa fa-check"></i><b>6</b> Linear regression, model selection, and prediction in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#learning-objectives-4"><i class="fa fa-check"></i><b>6.1</b> Learning objectives</a></li>
<li class="chapter" data-level="6.2" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#new-functions-syntax-4"><i class="fa fa-check"></i><b>6.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="6.3" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#the-problem-greenhouse-gas-emssisions-from-anthropogenic-land-use"><i class="fa fa-check"></i><b>6.3</b> The problem: greenhouse gas emssisions from anthropogenic land use</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#the-data-greenhouse-gases-and-reservoir-characteristics"><i class="fa fa-check"></i><b>6.3.1</b> <em>The data: greenhouse gases and reservoir characteristics</em></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#the-approach-linear-regression-in-r"><i class="fa fa-check"></i><b>6.4</b> The approach: Linear regression in R</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#transforming-variables"><i class="fa fa-check"></i><b>6.4.1</b> <em>Transforming variables</em></a></li>
<li class="chapter" data-level="6.4.2" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#binary-variables"><i class="fa fa-check"></i><b>6.4.2</b> <em>Binary variables</em></a></li>
<li class="chapter" data-level="6.4.3" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#running-a-multiple-regression"><i class="fa fa-check"></i><b>6.4.3</b> <em>Running a multiple regression</em></a></li>
<li class="chapter" data-level="6.4.4" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#checking-assumptions"><i class="fa fa-check"></i><b>6.4.4</b> <em>Checking assumptions</em></a></li>
<li class="chapter" data-level="6.4.5" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#multicollinearity"><i class="fa fa-check"></i><b>6.4.5</b> <em>5. Multicollinearity</em></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#model-selection"><i class="fa fa-check"></i><b>6.5</b> Model selection</a></li>
<li class="chapter" data-level="6.6" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#predictions"><i class="fa fa-check"></i><b>6.6</b> Predictions</a></li>
<li class="chapter" data-level="6.7" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#conclusions-1"><i class="fa fa-check"></i><b>6.7</b> Conclusions</a></li>
<li class="chapter" data-level="6.8" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#citations-2"><i class="fa fa-check"></i><b>6.8</b> Citations</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Environmental Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression-model-selection-and-prediction-in-r" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Linear regression, model selection, and prediction in R<a href="linear-regression-model-selection-and-prediction-in-r.html#linear-regression-model-selection-and-prediction-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>by Heather Kropp</em>
<em>for ENVST 325: Introduction to Environmental Data Science</em>
<em>Hamilton College</em></p>
<style type="text/css">
.book .book-body .page-wrapper .page-inner section.normal pre.colout {
  background-color: #D9EDF7;
}
</style>
<div id="learning-objectives-4" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Learning objectives<a href="linear-regression-model-selection-and-prediction-in-r.html#learning-objectives-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Conduct multiple linear regression in R</li>
<li>Transform variables for linear analysis</li>
<li>Consider model selection</li>
<li>Make predictions from a regression model</li>
<li>Analyze greenhouse gas emissions data from anthropogenic driven sources</li>
</ol>
</div>
<div id="new-functions-syntax-4" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> New functions &amp; syntax<a href="linear-regression-model-selection-and-prediction-in-r.html#new-functions-syntax-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>log</code>,<code>unique</code>,<code>lm</code>, <code>summary</code>, <code>qqnorm</code>, <code>qqline</code>, <code>rstandard</code>, <code>fitted.values</code>, <code>abline</code>, <code>chart.Correlation</code>, <code>ols_step_forward_aic</code>, <code>predict</code></p>
</div>
<div id="the-problem-greenhouse-gas-emssisions-from-anthropogenic-land-use" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> The problem: greenhouse gas emssisions from anthropogenic land use<a href="linear-regression-model-selection-and-prediction-in-r.html#the-problem-greenhouse-gas-emssisions-from-anthropogenic-land-use" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are many areas around the world that rely on surface water in rivers and lakes for a drinking and irrigation source. Man-made reservoirs are a common water management approach that involves constructing a dam to slow the flow of water in a river so that a lake may form upstream of the dam. This lake formation can ensure a stable water source for drinking and irrigation and electricity. However, reservoirs involve inundating areas of land that would not have been covered in water without a dam. Many of these areas would previously be covered with vegetation with soils rich in organic matter. There is an increasing concern that reservoirs can be sources of greenhouse gases, especially methane. Methane is a highly potent greenhouse gas. Methane is produced by bacteria in soils saturated with water with little oxygen. The flooded vegetation and organic rich soils offer ample food sources for bacteria and the low oxygen water environment is expect to promote greater production of methane than if the land was left unflooded. A new study by Deemer <em>et al.</em> compiled measurements of greenhouse gases taken from reservoirs around the world to examine the potential for reservoirs to be a source of greenhouse gas emissions. In this exercise, you will examine how much methane global reservoirs produce and examine the characteristics that drive greater methane production.</p>
<center>
<p><img src="photos/tutorial05/Lake_Vyrnwy_-_geograph.org.uk_-_1536682.jpg" style="width:66.0%" /></p>
<p><em>A dam helps form Lake Vyrnwy, a man-made reservoir. Source: Ray Jones CC2</em></p>
</center>
<div id="the-data-greenhouse-gases-and-reservoir-characteristics" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> <em>The data: greenhouse gases and reservoir characteristics</em><a href="linear-regression-model-selection-and-prediction-in-r.html#the-data-greenhouse-gases-and-reservoir-characteristics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The data collected by Deemer is a <strong>synthesis</strong> data set. A synthesis aim to compile data collected from a range of different studies to draw conclusions over a broader spatial scale with greater replication than the individual studies alone. However, synthesis often have to merge different observation approaches and some data may be missing if the original study did not collect it.</p>
<center>
<p><img src="photos/tutorial05/Deemer_map.png" style="width:66.0%" /></p>
</center>
<p>The <code>Deemer_GHG_Data.csv</code> file contains the greenhouse gas and reservoir characterstic data from sites shown in the map above.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb1-1" tabindex="-1"></a><span class="co"># read in greenhouse gas data from reservoirs</span></span>
<span id="cb1-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb1-2" tabindex="-1"></a>ghg <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;/cloud/project/activity05/Deemer_GHG_Data.csv&quot;</span>)</span></code></pre></div>
<pre class="colout"><code>           System Latitude Longitude Amazon    Region       Country Alpine
1 Acton Reservoir    39.57    -84.73     no Temperate United States       
2       Al-Wihdeh    32.73     35.87     no Temperate  Jordan/Syria       
3      Alamo Lake    34.25   -113.50     no Temperate United States       
4       Allatoona    34.14    -84.64     no Temperate United States       
5   Alouette Lake    49.32   -122.43     no Temperate        Canada       
6        Angerman    63.19     17.23     no    Boreal        Sweden       
  hydropower           Use   ch4     co2 age chlorophyll.a mean.depth
1         no    Recreation    NA   31.80  50         59.00        3.9
2    unknown                  NA 1445.45   3            NA         NA
3         no Flood Control    NA -199.22  35          3.58         NA
4        yes               22.12  446.38  63          4.40        9.2
5        yes                  NA -111.00  74            NA         NA
6        yes                  NA   30.80  70            NA         NA
  surface.area volume Residence.Time..days.    DIP precipitation runoff airTemp
1         2.50     NA                   292  21.64          1039    459   10.61
2         0.82   0.01                   247 138.71           349    124   19.60
3         4.22     NA                    NA   0.07           208      0   20.09
4        49.00   0.45                    36  43.84          1339    468   15.37
5        16.00     NA                    NA  40.14          1769   1198    8.24
6       854.00     NA                    NA   1.95           592    279    3.07</code></pre>
<p>There are a few main columns of data to focus on here. <code>ch4</code> describes the methane flux (<span class="math inline">\(mg CH_4-C\)</span> <span class="math inline">\(m^{-2}\)</span> <span class="math inline">\(day^{-1}\)</span>) in carbon equivalents emitted from the reservoir. The <code>co2</code> column gives the carbon dioxide flux (<span class="math inline">\(mg CO_2-C\)</span> <span class="math inline">\(m^{-2}\)</span> <span class="math inline">\(day^{-1}\)</span>) in carbon equivalents. If a carbon dioxide flux is negative, that means that the lake takes in more carbon dioxide than it emits. There are explanatory variables that also can influence the release of greenhouse gases. The depth of the reservoir (<code>mean.depth</code>, meters) can affect the exchange of oxygen, water chemistry, and microclimate. The age of the reservoir (<code>age</code>, years) can influence the availability of carbon and oxygen newly flooded vegetation and soils for microbes. The chlorophyll A measurements indicate how much photosynthesizing organisms are living in the water (<code>chlorophyll.a</code> in <span class="math inline">\(\mu g L^{-1}\)</span>). The surface area (<code>surface.area</code> in <span class="math inline">\(km^2\)</span>) and volume (<code>volume</code> in <span class="math inline">\(km^3\)</span>) can influence water conditions. The following are all variables modeled from global data that were used by the authors: dissolved inorganic phosphorous (<code>DIP</code> <span class="math inline">\(kg ~km^{-2}~ yr^{-1}\)</span>) influences the growth of microbes and photosynthetic organisms. Precipitation influences the flow of new water into the reservoir (<code>precipitation</code>, <span class="math inline">\(mm~ yr^{-1}\)</span>),
runoff is the total amount of water from precipitation that flows into a drainage basin (<code>runoff</code>, <span class="math inline">\(mm~ yr^{-1}\)</span>), and the air temperature influences the conditions for microbial and aquatic organisms as well as water chemistry (<code>airTemp</code>, <span class="math inline">\(^\circ C\)</span>).</p>
<p>You will also find it helpful to install and load the following packages:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb3-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb3-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-3"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb3-3" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span>
<span id="cb3-4"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb3-4" tabindex="-1"></a><span class="fu">library</span>(PerformanceAnalytics)</span></code></pre></div>
</div>
</div>
<div id="the-approach-linear-regression-in-r" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> The approach: Linear regression in R<a href="linear-regression-model-selection-and-prediction-in-r.html#the-approach-linear-regression-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="transforming-variables" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> <em>Transforming variables</em><a href="linear-regression-model-selection-and-prediction-in-r.html#transforming-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Methane emissions around bodies of water are a type of observation that tends to have many observations at low values with occasional very high value. The histogram of the methane data below confirms this.</p>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Keep in mind that the linear assumption for the ordinary least squares regression is: <strong>the parameters are linear, describing a linear relationship between two variables</strong>. This assumption simply gives the structure for <span class="math display">\[y = \beta_0 + \beta_1 * x\]</span>. However, either y or x does not have to be on a linear scale. In fact, y or x can be <strong>transformed</strong> to allow the data to be described on a linear scale. The most common type of transformation is a <strong>log-scale</strong> transformation. In R, the function <code>log</code> takes the natural log of data. The natural log often explains more relationships in environmental data than log base 10. Let’s transform the methane data before working with it. For the methane data, values of zero exist and there is no natural log of zero. However, including adding a value of one will shift all the data by a value, and any value that was zero on the linear scale will be zero on the log scale <code>log(1) = 0</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb4-1" tabindex="-1"></a><span class="co"># log transform methane fluxes</span></span>
<span id="cb4-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb4-2" tabindex="-1"></a>ghg<span class="sc">$</span>log.ch4 <span class="ot">&lt;-</span> <span class="fu">log</span>(ghg<span class="sc">$</span>ch4<span class="sc">+</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>You can see that the log scale results in a linear relationship between temperature and methane. Now the interpretation of the data in that linear relationship changes. As air temperature increases by one value, we are now looking at the increase in methane by one value on the log(ch4+1) scale.</p>
<p>Variables like total annual precipitation, age of the reservoir, and dissolved inorganic phosphorous would also be good values to transform due to their distribution and wide range of values.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb5-1" tabindex="-1"></a>ghg<span class="sc">$</span>log.age <span class="ot">&lt;-</span> <span class="fu">log</span>(ghg<span class="sc">$</span>age)</span>
<span id="cb5-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb5-2" tabindex="-1"></a>ghg<span class="sc">$</span>log.DIP <span class="ot">&lt;-</span> <span class="fu">log</span>(ghg<span class="sc">$</span>DIP<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb5-3"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb5-3" tabindex="-1"></a>ghg<span class="sc">$</span>log.precip <span class="ot">&lt;-</span> <span class="fu">log</span>(ghg<span class="sc">$</span>precipitation)</span></code></pre></div>
</div>
<div id="binary-variables" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> <em>Binary variables</em><a href="linear-regression-model-selection-and-prediction-in-r.html#binary-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It can be useful to control for categorical binary variables in a regression. A slope coefficient for these variables represents an addition or subtraction (if negative) to the intercept. This can account for an expectation for values of data being shifted higher or lower within this group category. There are a few variables where this might be helpful. Let’s use the <code>unique</code> function to look at all of the regions. Unique will print out each unique object in a vector with no duplicates.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb6-1" tabindex="-1"></a><span class="fu">unique</span>(ghg<span class="sc">$</span>Region)</span></code></pre></div>
<pre class="colout"><code>[1] &quot;Temperate&quot;   &quot;Boreal&quot;      &quot;Subtropical&quot; &quot;Tropical&quot;   </code></pre>
<p><code>ifelse</code> will be helpful here to make a binary variable (just like making a flag in the last tutorial). It will be helpful to isolate two regions. Boreal regions are known for their methane producing wetlands with organic rich soils and vegetation adapted to flooding, and thus we might expect that the flooded regions and the vegetation around a reservoir may be more prone to producing methane. We will also isolate tropical regions. There are studies that indicate that tropical lakes emit more methane so we might also expect emissions to differ from subtropical and temperature regions.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb8-1" tabindex="-1"></a><span class="co"># binary variable for boreal region</span></span>
<span id="cb8-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb8-2" tabindex="-1"></a>ghg<span class="sc">$</span>BorealV <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ghg<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;Boreal&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb8-3"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb8-3" tabindex="-1"></a><span class="co"># binary variable for tropical region</span></span>
<span id="cb8-4"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb8-4" tabindex="-1"></a>ghg<span class="sc">$</span>TropicalV <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ghg<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">&quot;Tropical&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code></pre></div>
<p>We will also want to create a variable for alpine regions (high elevation). Alpine regions are known for long term snow cover and glaciers that bring high amounts of cold, nutrient depleted melt water.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb9-1" tabindex="-1"></a><span class="co"># binary variable for alpine region</span></span>
<span id="cb9-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb9-2" tabindex="-1"></a>ghg<span class="sc">$</span>AlpineV <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ghg<span class="sc">$</span>Alpine <span class="sc">==</span> <span class="st">&quot;yes&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code></pre></div>
<p>Finally we will also add a variable that indicates that the reservoir is knowingly maintained for hydropower usage.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb10-1" tabindex="-1"></a><span class="co"># binary variable for known hydropower</span></span>
<span id="cb10-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb10-2" tabindex="-1"></a>ghg<span class="sc">$</span>HydroV <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ghg<span class="sc">$</span>hydropower <span class="sc">==</span> <span class="st">&quot;yes&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code></pre></div>
</div>
<div id="running-a-multiple-regression" class="section level3 hasAnchor" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> <em>Running a multiple regression</em><a href="linear-regression-model-selection-and-prediction-in-r.html#running-a-multiple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In R, the <code>lm</code> function allows you to specify a linear model and will automatically run an ordinary least squares regression. Here, we will focus on a multiple regression. The function can be easily altered to include only a single variable for a simple linear regression. The <code>lm</code> function expects a specific order of arguments where <code>y ~ x1 + x2</code> where y is the dependent variable, and x is one or more independent variables. Let’s set up a multiple regression for our methane fluxes that looks at the main variables that I predict will have the greatest impact: air temperature, reservoir age, reservoir depth, log-scale dissolved inorganic phosphorous, precipitation, and presence in a boreal region.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb11-1" tabindex="-1"></a><span class="co"># multiple regression</span></span>
<span id="cb11-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb11-2" tabindex="-1"></a><span class="co"># creates a model object</span></span>
<span id="cb11-3"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb11-3" tabindex="-1"></a>mod.full <span class="ot">&lt;-</span> <span class="fu">lm</span>(log.ch4 <span class="sc">~</span> airTemp<span class="sc">+</span></span>
<span id="cb11-4"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb11-4" tabindex="-1"></a>                log.age<span class="sc">+</span>mean.depth<span class="sc">+</span></span>
<span id="cb11-5"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb11-5" tabindex="-1"></a>                log.DIP<span class="sc">+</span></span>
<span id="cb11-6"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb11-6" tabindex="-1"></a>                log.precip<span class="sc">+</span> BorealV, <span class="at">data=</span>ghg) <span class="co">#uses the data argument to specify dataframe</span></span></code></pre></div>
<p>You can see the full model results using the <code>summary</code> function and referring to the model name. This will give you key information like the coefficients table and r-squared.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb12-1" tabindex="-1"></a><span class="fu">summary</span>(mod.full)</span></code></pre></div>
<pre class="colout"><code>
Call:
lm(formula = log.ch4 ~ airTemp + log.age + mean.depth + log.DIP + 
    log.precip + BorealV, data = ghg)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1437 -0.6877 -0.0805  0.6668  4.1080 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.413344   2.245865   3.746 0.000337 ***
airTemp      0.136628   0.018754   7.285 2.00e-10 ***
log.age     -0.161456   0.125556  -1.286 0.202177    
mean.depth  -0.010156   0.004548  -2.233 0.028336 *  
log.DIP      0.431204   0.141994   3.037 0.003227 ** 
log.precip  -1.166775   0.339196  -3.440 0.000927 ***
BorealV      1.936664   0.460385   4.207 6.72e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.31 on 80 degrees of freedom
  (180 observations deleted due to missingness)
Multiple R-squared:  0.5082,    Adjusted R-squared:  0.4714 
F-statistic: 13.78 on 6 and 80 DF,  p-value: 1.091e-10</code></pre>
<p>One thing to note is that almost half of the data was omitted due to a missing value in at least one of the columns included.</p>
<p>Assuming a standard confidence level of <span class="math inline">\(\alpha\)</span>= 0.05, you can see that some variables are related to methane fluxes but others do not have the relationship that I predicted.</p>
</div>
<div id="checking-assumptions" class="section level3 hasAnchor" number="6.4.4">
<h3><span class="header-section-number">6.4.4</span> <em>Checking assumptions</em><a href="linear-regression-model-selection-and-prediction-in-r.html#checking-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before moving on to closely interpreting this regression, it is a good idea to check the main assumptions of the regression:</p>
<ol style="list-style-type: decimal">
<li>Relationships are linear</li>
<li>Residuals are normally distributed</li>
<li>Residuals have equal variance</li>
<li>Residuals are independent and random</li>
<li>In a multiple regression, independent variables are not highly correlated (multicollinearity)</li>
</ol>
<p>It will be helpful to isolate standardized residuals (<code>rstandard</code>) and the fitted values from the regression line at each observation (<code>fitted.values</code>) for these tests.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb14-1" tabindex="-1"></a>res.full <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(mod.full)</span>
<span id="cb14-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb14-2" tabindex="-1"></a>fit.full <span class="ot">&lt;-</span> <span class="fu">fitted.values</span>(mod.full)</span></code></pre></div>
<div id="normality" class="section level4 hasAnchor" number="6.4.4.1">
<h4><span class="header-section-number">6.4.4.1</span> <em>1. Normality</em><a href="linear-regression-model-selection-and-prediction-in-r.html#normality" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You can use a qqplot to check normality of the residuals. For small data sets, the Shapiro-Wilks test (<code>shapiro.test</code>) can also be used to check normality.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb15-1" tabindex="-1"></a><span class="co"># qq plot</span></span>
<span id="cb15-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb15-2" tabindex="-1"></a><span class="fu">qqnorm</span>(res.full, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">&quot;grey50&quot;</span>)</span>
<span id="cb15-3"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb15-3" tabindex="-1"></a><span class="fu">qqline</span>(res.full)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb16-1" tabindex="-1"></a><span class="co"># shapiro-wilks test</span></span>
<span id="cb16-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb16-2" tabindex="-1"></a><span class="fu">shapiro.test</span>(res.full)</span></code></pre></div>
<pre class="colout"><code>
    Shapiro-Wilk normality test

data:  res.full
W = 0.98232, p-value = 0.2817</code></pre>
<p>You can see there are a few values that aren’t perfect but the data mainly follows the line. You can also see that the <code>shapiro.test</code> indicates the residuals do not significantly deviate from a normal distribution.</p>
</div>
<div id="residuals" class="section level4 hasAnchor" number="6.4.4.2">
<h4><span class="header-section-number">6.4.4.2</span> <em>2-4. Residuals</em><a href="linear-regression-model-selection-and-prediction-in-r.html#residuals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Many of the issues outlined in assumptions 2-4 can be seen using a residual plot and background knowledge about the data. A residual plot simpily uses the fitted values and standard residuals. You can add a horizontal line to the plot at zero for easier comparison.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb18-1" tabindex="-1"></a><span class="fu">plot</span>(fit.full,res.full, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">&quot;grey50&quot;</span>)</span>
<span id="cb18-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb18-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Here the residuals are not in major violation of any assumptions.</p>
</div>
</div>
<div id="multicollinearity" class="section level3 hasAnchor" number="6.4.5">
<h3><span class="header-section-number">6.4.5</span> <em>5. Multicollinearity</em><a href="linear-regression-model-selection-and-prediction-in-r.html#multicollinearity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The assumption of multicollinearity applies to multiple regressions only. Reliable slope coefficients assume that each independent variable is not related to other independent variables in the model. You can check this easily using the <code>chart.Correlation</code> function in the <code>PerformanceAnalytics</code> package. You simply need a data frame of just the variables to compare.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb19-1" tabindex="-1"></a><span class="co"># isolate continuous model variables into data frame:</span></span>
<span id="cb19-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb19-3" tabindex="-1"></a>reg.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ghg<span class="sc">$</span>airTemp,</span>
<span id="cb19-4"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb19-4" tabindex="-1"></a>  ghg<span class="sc">$</span>log.age,ghg<span class="sc">$</span>mean.depth,</span>
<span id="cb19-5"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb19-5" tabindex="-1"></a>  ghg<span class="sc">$</span>log.DIP,</span>
<span id="cb19-6"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb19-6" tabindex="-1"></a>  ghg<span class="sc">$</span>log.precip)</span>
<span id="cb19-7"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb19-7" tabindex="-1"></a></span>
<span id="cb19-8"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb19-8" tabindex="-1"></a><span class="co"># make a correlation matrix </span></span>
<span id="cb19-9"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb19-9" tabindex="-1"></a><span class="fu">chart.Correlation</span>(reg.data, <span class="at">histogram=</span><span class="cn">TRUE</span>, <span class="at">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<pre><code>Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter</code></pre>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>A correlation coefficient varies from 0-1 with 1 indicated a perfect correlation. There is no established threshold for multicollinearity, but some studies indicate that correlation coefficients greater than 0.7-0.8 indicate that both variables are too correlated to include. The solution to this is to choose just one variable knowing that it may represent other underlying variables and processes (include this in your interpretation). The other solution is to create an index that represents both variables.</p>
<p>Here, there are a few variables that have a fair amount of correlation, but there is not a severe enough correlation to cause concern here.</p>
</div>
</div>
<div id="model-selection" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Model selection<a href="linear-regression-model-selection-and-prediction-in-r.html#model-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Model selection is one of the most challenging parts of designing an analysis. My selection of initial variables related to my biophysical understanding of microbial respiration, aquatic ecosystems, and microclimate. However, you can see that some variables are simply not significant and indicate no relationship. This outcome would be useful to report for <strong>inference</strong>. Understanding which variables influence methane emission and by how much provides more information about when and why reservoirs may be significant sources of methane. However, if I am interested in <strong>prediction</strong>, I will only want to include significant variables that greatly describe the variability in methane to reduce data collection and issues with over-fitting. <strong>Model selection</strong> is the process of eliminating variables and parameters that are not critical to the objective of the analysis and the outcomes of the model.</p>
<p>There are various ways of assessing model performance. The <span class="math inline">\(R^2\)</span> gives information on the amount of variability in y explained by the model. The adjusted <span class="math inline">\(R^2\)</span> penalizes the addition of extra independent variables. The <strong>Akaike information criterion (AIC)</strong> is a measure of model fit. The smaller the value, the better the model fit. Comparing these measures between <strong>candidate models</strong>, a series of possible models to compare. Model selection can help with statistically selecting variables that best describe the independent variable without adding unnecessary variables.</p>
<p>You can assess the importance of your variables in a multiple regression using <strong>stepwise selection</strong>. Stepwise selection iteratively adds (forward) or removes (backward) variables to calculate their impact on the model. Let’s look at forward stepwise selection using the function <code>ols_step_forward_aic</code> function from the <code>olsrr</code> package. The only argument needed is your full model.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb21-1" tabindex="-1"></a><span class="co"># run stepwise</span></span>
<span id="cb21-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb21-2" tabindex="-1"></a>full.step <span class="ot">&lt;-</span> <span class="fu">ols_step_forward_aic</span>(mod.full)</span>
<span id="cb21-3"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb21-3" tabindex="-1"></a><span class="co"># view table</span></span>
<span id="cb21-4"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb21-4" tabindex="-1"></a>full.step </span></code></pre></div>
<pre class="colout"><code>
                             Stepwise Summary                              
-------------------------------------------------------------------------
Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
-------------------------------------------------------------------------
 0      Base Model    352.361    357.293    104.103    0.00000    0.00000 
 1      airTemp       331.606    339.003     83.302    0.23015    0.22109 
 2      BorealV       314.366    324.230     66.635    0.38289    0.36819 
 3      log.precip    310.582    322.911     63.085    0.42258    0.40171 
 4      log.DIP       305.395    320.190     58.559    0.46836    0.44243 
 5      mean.depth    302.392    319.653     56.274    0.49807    0.46709 
-------------------------------------------------------------------------

Final Model Output 
------------------

                         Model Summary                          
---------------------------------------------------------------
R                       0.706       RMSE                 1.269 
R-Squared               0.498       MSE                  1.731 
Adj. R-Squared          0.467       Coef. Var           52.761 
Pred R-Squared          0.393       AIC                302.392 
MAE                     0.963       SBC                319.653 
---------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 
 AIC: Akaike Information Criteria 
 SBC: Schwarz Bayesian Criteria 

                               ANOVA                                
-------------------------------------------------------------------
               Sum of                                              
              Squares        DF    Mean Square      F         Sig. 
-------------------------------------------------------------------
Regression    139.098         5         27.820    16.076    0.0000 
Residual      140.174        81          1.731                     
Total         279.271        86                                    
-------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)     7.841         2.210                  3.548    0.001     3.443    12.238 
    airTemp     0.142         0.018        0.816     7.679    0.000     0.105     0.178 
    BorealV     2.065         0.451        0.467     4.578    0.000     1.168     2.963 
 log.precip    -1.158         0.340       -0.353    -3.401    0.001    -1.835    -0.480 
    log.DIP     0.399         0.140        0.283     2.845    0.006     0.120     0.679 
 mean.depth    -0.010         0.005       -0.174    -2.190    0.031    -0.019    -0.001 
----------------------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb23-1" tabindex="-1"></a><span class="co"># check full model</span></span>
<span id="cb23-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb23-2" tabindex="-1"></a>full.step<span class="sc">$</span>model</span></code></pre></div>
<pre class="colout"><code>
Call:
lm(formula = paste(response, &quot;~&quot;, paste(preds, collapse = &quot; + &quot;)), 
    data = l)

Coefficients:
(Intercept)      airTemp      BorealV   log.precip      log.DIP   mean.depth  
   7.840642     0.141549     2.065391    -1.157859     0.399330    -0.009994  </code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb25-1" tabindex="-1"></a><span class="co"># plot AIC over time</span></span>
<span id="cb25-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb25-2" tabindex="-1"></a><span class="fu">plot</span>(full.step )</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>THe main thing that you want to interpret here is how much the AIC and adjusted <span class="math inline">\(R^2\)</span> change with each added variable. You can see here that the log(DIP+1) had almost no influence on the model despite being statistically significant. This information is helpful for both inference and prediction. Adding the air temperature variable increased the adjusted <span class="math inline">\(R^2\)</span> and decreased the AIC by the greatest magnitude.</p>
</div>
<div id="predictions" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Predictions<a href="linear-regression-model-selection-and-prediction-in-r.html#predictions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Regression lines can be used to make predict for missing data. In R, the <code>predict.lm</code> function can be used to predict the value from the regression model for given input data values. Here, you need to specify the input model, input independent variables, and the interval to return. <code>confidence</code> returns the 95% confidence interval whereas <code>prediction</code> returns the interval for a single point of data. The prediction variable accounts for the extra variability of each regression point around the line (think about that error term in the regression equation).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb26-1" tabindex="-1"></a><span class="co"># prediction with interval for predicting a point</span></span>
<span id="cb26-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb26-2" tabindex="-1"></a><span class="fu">predict.lm</span>(mod.full, <span class="fu">data.frame</span>(<span class="at">airTemp=</span><span class="dv">20</span>,<span class="at">log.age=</span><span class="fu">log</span>(<span class="dv">2</span>),</span>
<span id="cb26-3"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb26-3" tabindex="-1"></a>                             <span class="at">mean.depth=</span><span class="dv">15</span>,<span class="at">log.DIP=</span><span class="dv">3</span>,</span>
<span id="cb26-4"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb26-4" tabindex="-1"></a>                             <span class="at">log.precip=</span><span class="dv">6</span>, <span class="at">BorealV=</span><span class="dv">0</span>),</span>
<span id="cb26-5"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb26-5" tabindex="-1"></a>           <span class="at">interval=</span><span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<pre class="colout"><code>       fit      lwr      upr
1 5.174622 2.347429 8.001815</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb28-1" tabindex="-1"></a><span class="co"># look at prediction with 95% confidence interval of the mean</span></span>
<span id="cb28-2"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb28-3" tabindex="-1"></a><span class="fu">predict.lm</span>(mod.full, <span class="fu">data.frame</span>(<span class="at">airTemp=</span><span class="dv">20</span>,<span class="at">log.age=</span><span class="fu">log</span>(<span class="dv">2</span>),</span>
<span id="cb28-4"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb28-4" tabindex="-1"></a>                                <span class="at">mean.depth=</span><span class="dv">15</span>,<span class="at">log.DIP=</span><span class="dv">3</span>,</span>
<span id="cb28-5"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb28-5" tabindex="-1"></a>                                <span class="at">log.precip=</span><span class="dv">6</span>, <span class="at">BorealV=</span><span class="dv">0</span>),</span>
<span id="cb28-6"><a href="linear-regression-model-selection-and-prediction-in-r.html#cb28-6" tabindex="-1"></a>           <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>)</span></code></pre></div>
<pre class="colout"><code>       fit      lwr     upr
1 5.174622 4.081764 6.26748</code></pre>
</div>
<div id="conclusions-1" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Conclusions<a href="linear-regression-model-selection-and-prediction-in-r.html#conclusions-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can see that reservoirs are a significant source of methane in some cases, but some reservoirs produce more methane than others. It seems that areas with high air temperatures, lower amounts of annual precipitation, or in boreal regions are prone to higher levels of methane. With this information, we can understand the impact of reservoirs on greenhouse gas emissions across the globe or predict the carbon footprint of a proposed reservoir. You will practice implementing, designing,and selecting linear models further in class and homework.</p>
</div>
<div id="citations-2" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Citations<a href="linear-regression-model-selection-and-prediction-in-r.html#citations-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Deemer, Bridget R., et al. “Greenhouse gas emissions from reservoir water surfaces: a new global synthesis.” BioScience 66.11 (2016): 949-964.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
