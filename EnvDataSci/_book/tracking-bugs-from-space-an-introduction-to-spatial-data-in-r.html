<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Tracking bugs from space?!?! An introduction to spatial data in R | Introduction to Environmental Data Science</title>
  <meta name="description" content="“ENVST 325: Environmental Data Science, Hamilton College”" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Tracking bugs from space?!?! An introduction to spatial data in R | Introduction to Environmental Data Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="“ENVST 325: Environmental Data Science, Hamilton College”" />
  <meta name="github-repo" content="kroppheather/Intro_EnvDataSci" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Tracking bugs from space?!?! An introduction to spatial data in R | Introduction to Environmental Data Science" />
  
  <meta name="twitter:description" content="“ENVST 325: Environmental Data Science, Hamilton College”" />
  

<meta name="author" content="Heather Kropp" />


<meta name="date" content="2024-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#course-learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Course Learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#license"><i class="fa fa-check"></i><b>1.2</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html"><i class="fa fa-check"></i><b>2</b> Introduction to R Statistical Software and Git</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#new-functions-syntax"><i class="fa fa-check"></i><b>2.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#first-some-terms"><i class="fa fa-check"></i><b>2.3</b> First some terms:</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#setting-up-a-repository-in-github"><i class="fa fa-check"></i><b>2.4</b> Setting up a Repository in GitHub</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#create-a-repository"><i class="fa fa-check"></i><b>2.4.1</b> <em>Create a repository</em></a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#create-a-personal-token-for-rstudio-cloud"><i class="fa fa-check"></i><b>2.4.2</b> <em>Create a personal token for Rstudio Cloud</em></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#start-a-project-with-version-control-in-rstudio-cloud"><i class="fa fa-check"></i><b>2.5</b> Start a project with version control in Rstudio Cloud</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#start-a-project-linked-with-a-repository"><i class="fa fa-check"></i><b>2.5.1</b> <em>Start a project linked with a repository</em></a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#rstudio-interface"><i class="fa fa-check"></i><b>2.5.2</b> <em>Rstudio interface</em></a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#version-control"><i class="fa fa-check"></i><b>2.5.3</b> <em>Version control</em></a></li>
<li class="chapter" data-level="2.5.4" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#commit-your-first-changes-to-github"><i class="fa fa-check"></i><b>2.5.4</b> <em>Commit your first changes to GitHub</em></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#introrefresher-on-r"><i class="fa fa-check"></i><b>2.6</b> Intro/Refresher on R</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#variables"><i class="fa fa-check"></i><b>2.7</b> Variables</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#vectors"><i class="fa fa-check"></i><b>2.7.1</b> <em>Vectors</em></a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-r-statistical-software-and-git.html"><a href="introduction-to-r-statistical-software-and-git.html#data-frames"><i class="fa fa-check"></i><b>2.7.2</b> <em>Data frames</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html"><i class="fa fa-check"></i><b>3</b> The data deluge: data wrangling in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#learning-objectives-1"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#new-functions-syntax-1"><i class="fa fa-check"></i><b>3.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="3.3" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#the-problem"><i class="fa fa-check"></i><b>3.3</b> The problem:</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#flooding-and-natural-disasters"><i class="fa fa-check"></i><b>3.3.1</b> <em>Flooding and natural disasters</em></a></li>
<li class="chapter" data-level="3.3.2" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#the-data-flood-stage-stream-guage-height"><i class="fa fa-check"></i><b>3.3.2</b> <em>The data: flood stage &amp; stream guage height</em></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#the-approach-packages-in-r"><i class="fa fa-check"></i><b>3.4</b> The approach: packages in R</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#installing-packages"><i class="fa fa-check"></i><b>3.4.1</b> <em>Installing packages</em></a></li>
<li class="chapter" data-level="3.4.2" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#loading-packages"><i class="fa fa-check"></i><b>3.4.2</b> <em>Loading packages</em></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#the-approach-data-wrangling"><i class="fa fa-check"></i><b>3.5</b> The approach: data wrangling</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#reading-in-data"><i class="fa fa-check"></i><b>3.5.1</b> <em>Reading in data</em></a></li>
<li class="chapter" data-level="3.5.2" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#parsing-datetime"><i class="fa fa-check"></i><b>3.5.2</b> <em>Parsing date/time</em></a></li>
<li class="chapter" data-level="3.5.3" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#extracting-information-from-dates"><i class="fa fa-check"></i><b>3.5.3</b> <em>Extracting information from dates</em></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#basic-subsetting"><i class="fa fa-check"></i><b>3.6</b> <em>Basic subsetting</em></a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#basic-plotting"><i class="fa fa-check"></i><b>3.6.1</b> <em>Basic plotting</em></a></li>
<li class="chapter" data-level="3.6.2" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#joining-data-tables-with-a-common-feature"><i class="fa fa-check"></i><b>3.6.2</b> <em>Joining data tables with a common feature</em></a></li>
<li class="chapter" data-level="3.6.3" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#aggregating-data-chaining-functions"><i class="fa fa-check"></i><b>3.6.3</b> <em>Aggregating data &amp; chaining functions</em></a></li>
<li class="chapter" data-level="3.6.4" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#filtering-data"><i class="fa fa-check"></i><b>3.6.4</b> <em>Filtering data</em></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="the-data-deluge-data-wrangling-in-r.html"><a href="the-data-deluge-data-wrangling-in-r.html#citations"><i class="fa fa-check"></i><b>3.7</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html"><i class="fa fa-check"></i><b>4</b> Data visualization in R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#learning-objectives-2"><i class="fa fa-check"></i><b>4.1</b> Learning objectives</a></li>
<li class="chapter" data-level="4.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#new-functions-syntax-2"><i class="fa fa-check"></i><b>4.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="4.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#the-problem-1"><i class="fa fa-check"></i><b>4.3</b> The problem:</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#communicating-about-climate-change"><i class="fa fa-check"></i><b>4.3.1</b> <em>Communicating about climate change</em></a></li>
<li class="chapter" data-level="4.3.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#the-data"><i class="fa fa-check"></i><b>4.3.2</b> <em>The data</em></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#fundamentals-of-plotting-data"><i class="fa fa-check"></i><b>4.4</b> Fundamentals of plotting data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#representation-of-data"><i class="fa fa-check"></i><b>4.4.1</b> <em>1. Representation of data</em></a></li>
<li class="chapter" data-level="4.4.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#layout"><i class="fa fa-check"></i><b>4.4.2</b> <em>2. Layout</em></a></li>
<li class="chapter" data-level="4.4.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#encoding"><i class="fa fa-check"></i><b>4.4.3</b> <em>3. Encoding</em></a></li>
<li class="chapter" data-level="4.4.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#simplicity"><i class="fa fa-check"></i><b>4.4.4</b> <em>4. Simplicity</em></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#plotting-data-in-base-r"><i class="fa fa-check"></i><b>4.5</b> Plotting data in base R</a></li>
<li class="chapter" data-level="4.6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#plotting-in-ggplot2"><i class="fa fa-check"></i><b>4.6</b> Plotting in ggplot2</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#intro-to-ggplot"><i class="fa fa-check"></i><b>4.6.1</b> <em>Intro to ggplot</em></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#changing-colors"><i class="fa fa-check"></i><b>4.6.2</b> <em>Changing colors</em></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#exploring-different-visualizations-in-ggplot2"><i class="fa fa-check"></i><b>4.6.3</b> Exploring different visualizations in ggplot2</a></li>
<li class="chapter" data-level="4.6.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#violin-and-box-plots"><i class="fa fa-check"></i><b>4.6.4</b> <em>Violin and box plots</em></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#area-and-ribbon-plots"><i class="fa fa-check"></i><b>4.6.5</b> <em>Area and ribbon plots</em></a></li>
<li class="chapter" data-level="4.6.6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#labels"><i class="fa fa-check"></i><b>4.6.6</b> <em>Labels</em></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#conclusions"><i class="fa fa-check"></i><b>4.7</b> Conclusions</a></li>
<li class="chapter" data-level="4.8" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#citations-1"><i class="fa fa-check"></i><b>4.8</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><i class="fa fa-check"></i><b>5</b> When it rains, it pours. An introduction to data cleaning.</a>
<ul>
<li class="chapter" data-level="5.1" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#learning-objectives-3"><i class="fa fa-check"></i><b>5.1</b> Learning objectives</a></li>
<li class="chapter" data-level="5.2" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#new-functions-syntax-3"><i class="fa fa-check"></i><b>5.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="5.3" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#the-problem-ensuring-reliable-data"><i class="fa fa-check"></i><b>5.3</b> The problem: ensuring reliable data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#sensors-for-weather-and-microclimate"><i class="fa fa-check"></i><b>5.3.1</b> <em>Sensors for weather and microclimate</em></a></li>
<li class="chapter" data-level="5.3.2" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#problematic-data"><i class="fa fa-check"></i><b>5.3.2</b> <em>Problematic data</em></a></li>
<li class="chapter" data-level="5.3.3" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#the-data-1"><i class="fa fa-check"></i><b>5.3.3</b> <em>The data</em></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#cleaning-data"><i class="fa fa-check"></i><b>5.4</b> Cleaning data</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#removing-unreliable-data"><i class="fa fa-check"></i><b>5.4.1</b> <em>Removing unreliable data</em></a></li>
<li class="chapter" data-level="5.4.2" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#creating-flags"><i class="fa fa-check"></i><b>5.4.2</b> <em>Creating flags</em></a></li>
<li class="chapter" data-level="5.4.3" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#creating-functions-to-check-data"><i class="fa fa-check"></i><b>5.4.3</b> <em>Creating functions to check data</em></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html"><a href="when-it-rains-it-pours.-an-introduction-to-data-cleaning..html#conclusion"><i class="fa fa-check"></i><b>5.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html"><i class="fa fa-check"></i><b>6</b> Linear regression, model selection, and prediction in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#learning-objectives-4"><i class="fa fa-check"></i><b>6.1</b> Learning objectives</a></li>
<li class="chapter" data-level="6.2" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#new-functions-syntax-4"><i class="fa fa-check"></i><b>6.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="6.3" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#the-problem-greenhouse-gas-emssisions-from-anthropogenic-land-use"><i class="fa fa-check"></i><b>6.3</b> The problem: greenhouse gas emssisions from anthropogenic land use</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#the-data-greenhouse-gases-and-reservoir-characteristics"><i class="fa fa-check"></i><b>6.3.1</b> <em>The data: greenhouse gases and reservoir characteristics</em></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#the-approach-linear-regression-in-r"><i class="fa fa-check"></i><b>6.4</b> The approach: Linear regression in R</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#transforming-variables"><i class="fa fa-check"></i><b>6.4.1</b> <em>Transforming variables</em></a></li>
<li class="chapter" data-level="6.4.2" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#binary-variables"><i class="fa fa-check"></i><b>6.4.2</b> <em>Binary variables</em></a></li>
<li class="chapter" data-level="6.4.3" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#running-a-multiple-regression"><i class="fa fa-check"></i><b>6.4.3</b> <em>Running a multiple regression</em></a></li>
<li class="chapter" data-level="6.4.4" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#checking-assumptions"><i class="fa fa-check"></i><b>6.4.4</b> <em>Checking assumptions</em></a></li>
<li class="chapter" data-level="6.4.5" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#multicollinearity"><i class="fa fa-check"></i><b>6.4.5</b> <em>5. Multicollinearity</em></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#model-selection"><i class="fa fa-check"></i><b>6.5</b> Model selection</a></li>
<li class="chapter" data-level="6.6" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#predictions"><i class="fa fa-check"></i><b>6.6</b> Predictions</a></li>
<li class="chapter" data-level="6.7" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#conclusions-1"><i class="fa fa-check"></i><b>6.7</b> Conclusions</a></li>
<li class="chapter" data-level="6.8" data-path="linear-regression-model-selection-and-prediction-in-r.html"><a href="linear-regression-model-selection-and-prediction-in-r.html#citations-2"><i class="fa fa-check"></i><b>6.8</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><i class="fa fa-check"></i><b>7</b> Thirsty crops and water scarcity. An introduction to time series</a>
<ul>
<li class="chapter" data-level="7.1" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html#learning-objectives-5"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html#new-functions-syntax-5"><i class="fa fa-check"></i><b>7.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="7.3" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html#the-problem-irrigation-and-water-security"><i class="fa fa-check"></i><b>7.3</b> The problem: Irrigation and water security</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html#the-data-satellite-observations-of-evapotranspiration"><i class="fa fa-check"></i><b>7.3.1</b> <em>The data: satellite observations of evapotranspiration</em></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html#the-approach-analyzing-and-forecasting-a-time-series"><i class="fa fa-check"></i><b>7.4</b> The approach: Analyzing and forecasting a time series</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html#setting-up-a-time-series-data-type"><i class="fa fa-check"></i><b>7.4.1</b> <em>Setting up a time series data type</em></a></li>
<li class="chapter" data-level="7.4.2" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html#decomposing-a-time-series"><i class="fa fa-check"></i><b>7.4.2</b> <em>Decomposing a time series</em></a></li>
<li class="chapter" data-level="7.4.3" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html#autocorrelation"><i class="fa fa-check"></i><b>7.4.3</b> <em>Autocorrelation</em></a></li>
<li class="chapter" data-level="7.4.4" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html#autoregressive-ar-models-for-time-series"><i class="fa fa-check"></i><b>7.4.4</b> <em>Autoregressive (AR) models for time series</em></a></li>
<li class="chapter" data-level="7.4.5" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html#forecast-future-data"><i class="fa fa-check"></i><b>7.4.5</b> <em>Forecast future data</em></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html#conclusions-2"><i class="fa fa-check"></i><b>7.5</b> Conclusions</a></li>
<li class="chapter" data-level="7.6" data-path="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html"><a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html#citations-3"><i class="fa fa-check"></i><b>7.6</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><i class="fa fa-check"></i><b>8</b> Tracking bugs from space?!?! An introduction to spatial data in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#learning-objectives-6"><i class="fa fa-check"></i><b>8.1</b> Learning objectives</a></li>
<li class="chapter" data-level="8.2" data-path="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#new-functions-syntax-6"><i class="fa fa-check"></i><b>8.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="8.3" data-path="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#the-problem-monitoring-pest-outbreaks"><i class="fa fa-check"></i><b>8.3</b> The problem: monitoring pest outbreaks</a></li>
<li class="chapter" data-level="8.4" data-path="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#the-data-2"><i class="fa fa-check"></i><b>8.4</b> The data:</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#raster-data-sentinel-2-imagery"><i class="fa fa-check"></i><b>8.4.1</b> <em>Raster data: Sentinel 2 imagery</em></a></li>
<li class="chapter" data-level="8.4.2" data-path="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#vector-data"><i class="fa fa-check"></i><b>8.4.2</b> <em>Vector data:</em></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#the-approach-ndvi-in-r"><i class="fa fa-check"></i><b>8.5</b> The approach: NDVI in R</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#ndvi-calculations"><i class="fa fa-check"></i><b>8.5.1</b> <em>NDVI calculations</em></a></li>
<li class="chapter" data-level="8.5.2" data-path="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#extract-data-in-a-vector-geometry"><i class="fa fa-check"></i><b>8.5.2</b> <em>Extract data in a vector geometry</em></a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#conclusions-3"><i class="fa fa-check"></i><b>8.6</b> Conclusions</a></li>
<li class="chapter" data-level="8.7" data-path="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#citations-4"><i class="fa fa-check"></i><b>8.7</b> Citations</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Environmental Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Tracking bugs from space?!?! An introduction to spatial data in R<a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#tracking-bugs-from-space-an-introduction-to-spatial-data-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>by Heather Kropp</em>
<em>for ENVST 325: Introduction to Environmental Data Science</em>
<em>Hamilton College</em></p>
<style type="text/css">
.book .book-body .page-wrapper .page-inner section.normal pre.colout {
  background-color: #D9EDF7;
}
</style>
<div id="learning-objectives-6" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Learning objectives<a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#learning-objectives-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Work with raster and vector data in R</li>
<li>Calcualte NDVI</li>
<li>Track spongy moth defioliation with satellite data</li>
</ol>
</div>
<div id="new-functions-syntax-6" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> New functions &amp; syntax<a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#new-functions-syntax-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>rast</code>, <code>stack</code>, <code>st_read</code>, <code>plotRGB</code>,<code>extract</code></p>
</div>
<div id="the-problem-monitoring-pest-outbreaks" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> The problem: monitoring pest outbreaks<a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#the-problem-monitoring-pest-outbreaks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Throughout much of the world, insect and fungal pests can be a common disturbance to forests resulting in outcomes like defoliation and death. The spongy moth ( <em>Lymantria dispar dispar</em>) is a common pest to the northeastern United states that infests forests and eats the leaf foliage. According the the New York State Department of Environmental Conservation, spongy moths were introduced to the US in the 1800s via a silkworm breeding program.</p>
<center>
<p><img src="photos/tutorial07/moth2.jpg" style="width:50.0%" /></p>
<p><em>Source:A Spongy moth consumes leaves. Patrick Reijnders CC3</em></p>
</center>
<p>Large outbreaks can defoliate entire forest stands. Deciduous tree leaves can regrow within the summer. This means that the outbreaks are mostly harmless, but successive years of outbreak or outbreaks co-occurring with other stresses like drought may lead to mortality. Outbreaks can also make trees more susceptible to other pests. Evergreen needleleaf trees may have more difficulty regrowing leaves and can be more susceptible to mortality. The installation of barriers and insecticides can help control spongy moth outbreaks. Tracking outbreaks can help inform forest monitoring and multiple sequential years of outbreaks may suggest spongy moth control measures may be warranted. As you can see from the image below, outbreaks can cover large areas of land that can be difficult to quantify from the ground.</p>
<center>
<p><img src="photos/tutorial07/Moth_Defoliation_PA.jpg" style="width:50.0%" /></p>
<p><em>An aerial image of spongy moth defoliation in Pennsylvania. Source: Dhalusa CC3</em></p>
</center>
</div>
<div id="the-data-2" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> The data:<a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#the-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="raster-data-sentinel-2-imagery" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> <em>Raster data: Sentinel 2 imagery</em><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#raster-data-sentinel-2-imagery" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Changes in vegetation over large spatial extents can be quantified from satellite imagery. As discussed in class, the reflectance of light in different wavelengths can be used characterize vegetation, water and other features on the land surface. In this activity, you will work with data from the Sentinel 2 satellite. You will work with Bands 2 (blue), 3 (green), 4 (red), and 8 (near-infrared). A lot of satellite image data is stored in a <strong>GeoTiff</strong> format. This format stores the data as an image with additional metadata in the file and includes the geographic information. The <code>raster</code> package can be used to read, analyze, and map these images. The <code>sf</code> package contains functions for working with vector data. Let’s load the packages into the environment:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code></pre></div>
<pre><code>terra 1.7.78</code></pre>
<pre><code>
Attaching package: &#39;terra&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:imager&#39;:

    depth, width</code></pre>
<pre><code>The following objects are masked from &#39;package:magrittr&#39;:

    extract, inset</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb6-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Each image can actually contain multiple images organized in a <strong>rast</strong>. Here, each tiff file contains four images from each band so you will want to read in the file using the `rast`` function. In the summer of 2021, a major spongy moth outbreak occurred around Lake George in New York State. There is a pre- and post- outbreak image. Let’s read the images in:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb7-1" tabindex="-1"></a><span class="co"># pre outbreak image</span></span>
<span id="cb7-2"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb7-2" tabindex="-1"></a>pre <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">&quot;/cloud/project/activity07/ldd_pre.tif&quot;</span>)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb8-1" tabindex="-1"></a><span class="co"># post outbreak image</span></span>
<span id="cb8-2"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb8-2" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">&quot;/cloud/project/activity07/ldd_post.tif&quot;</span>)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>You can view the components of the stack using the <code>plot</code> function and set a greyscale using <code>col</code> and <code>grey</code>. You can see each band plotted:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(pre, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span><span class="sc">/</span><span class="dv">100</span>) )</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-10-1.png" width="1152" /></p>
<p>Sentinel 2 data is represented as a <strong>digital number</strong> where the actual reflectance is multiplied by 10,000 for each band. Since we are only working with sentinel data, we don’t need to convert to an actual reflectance value (0-1 scale).</p>
<p>You can also make a <strong>color composite</strong> using the plotRGB function. By changing the bands, you can make the <strong>false color composites</strong>. The <code>plotRGB</code> function uses three bands to make a composite of red, green, blue color in an image. The <code>scale</code> argument specifies the maximum data value (255 will be assumed by default because that is a common value for image data). Color contrast can also be added using the <code>stretch</code> argument.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb10-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb10-2"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb10-3" tabindex="-1"></a><span class="fu">plotRGB</span>(post, <span class="at">r=</span><span class="dv">3</span>,<span class="at">g=</span><span class="dv">2</span>,<span class="at">b=</span><span class="dv">1</span>, <span class="co"># image and bands</span></span>
<span id="cb10-4"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb10-4" tabindex="-1"></a>        <span class="at">scale=</span><span class="dv">13000</span>, <span class="co"># note high scale due to clouds</span></span>
<span id="cb10-5"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb10-5" tabindex="-1"></a>        <span class="at">stretch=</span><span class="st">&quot;lin&quot;</span>, <span class="co"># contrast stretch</span></span>
<span id="cb10-6"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb10-6" tabindex="-1"></a>        <span class="at">main=</span><span class="st">&quot;True color&quot;</span>,</span>
<span id="cb10-7"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb10-7" tabindex="-1"></a>        <span class="at">axes=</span><span class="cn">TRUE</span>)</span>
<span id="cb10-8"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb10-8" tabindex="-1"></a><span class="fu">plotRGB</span>(post, <span class="at">r=</span><span class="dv">4</span>,<span class="at">g=</span><span class="dv">3</span>,<span class="at">b=</span><span class="dv">2</span>, <span class="co"># image and bands</span></span>
<span id="cb10-9"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb10-9" tabindex="-1"></a>        <span class="at">scale=</span><span class="dv">13000</span>,<span class="co"># max data value</span></span>
<span id="cb10-10"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb10-10" tabindex="-1"></a>        <span class="at">stretch=</span><span class="st">&quot;lin&quot;</span>, <span class="co"># contrast stretch</span></span>
<span id="cb10-11"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb10-11" tabindex="-1"></a>        <span class="at">main=</span><span class="st">&quot;False color&quot;</span>,</span>
<span id="cb10-12"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb10-12" tabindex="-1"></a>        <span class="at">axes=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-11-1.png" width="960" /></p>
</div>
<div id="vector-data" class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> <em>Vector data:</em><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#vector-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You have been given two areas around Lake George towards the North of the lake and in the central region of the lake to track outbreaks. You would like to use these boundaries in your calculations:</p>
<p>The <code>terra</code> package also works with vector data. This includes points, polygons, and lines with attribute table data. The <code>vect</code> function loads the data into R:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb11-1" tabindex="-1"></a>northBound <span class="ot">&lt;-</span> <span class="fu">vect</span>(<span class="st">&quot;/cloud/project/activity07/north_bound.shp&quot;</span>)</span>
<span id="cb11-2"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb11-3" tabindex="-1"></a>midBound <span class="ot">&lt;-</span> <span class="fu">vect</span>(<span class="st">&quot;/cloud/project/activity07/mid_bound.shp&quot;</span>)</span></code></pre></div>
<p>You can add these polygons to your plot by specifically referring the the <code>geometry</code> column and using the <code>add=TRUE</code> argument. Here the plot function defaluts to an sf plot. You can also find more arguments like <code>fill</code> for working with polygons:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb12-1" tabindex="-1"></a><span class="fu">plotRGB</span>(post, <span class="at">r=</span><span class="dv">3</span>,<span class="at">g=</span><span class="dv">2</span>,<span class="at">b=</span><span class="dv">1</span>, <span class="at">stretch=</span><span class="st">&quot;lin&quot;</span>)</span>
<span id="cb12-2"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb12-2" tabindex="-1"></a><span class="fu">plot</span>(northBound, <span class="at">border=</span><span class="st">&quot;tomato3&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>Warning in graphics::plot.xy(g, type = &quot;l&quot;, lty = lty, col = col, lwd = lwd, :
&quot;fill&quot; is not a graphical parameter</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb14-1" tabindex="-1"></a><span class="fu">plot</span>(midBound, <span class="at">border=</span><span class="st">&quot;royalblue4&quot;</span>,<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>Warning in graphics::plot.xy(g, type = &quot;l&quot;, lty = lty, col = col, lwd = lwd, :
&quot;fill&quot; is not a graphical parameter</code></pre>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="the-approach-ndvi-in-r" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> The approach: NDVI in R<a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#the-approach-ndvi-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ndvi-calculations" class="section level3 hasAnchor" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> <em>NDVI calculations</em><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#ndvi-calculations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculations on rasters will be very familar in R. You can directly apply functions and calculations to a raster cell just like you are used with vectors and data frames. If you remember, the <strong>Normalized Difference Vegetation Index</strong> is calculated based on the normalized difference between near infrared and red reflectance. Values of -1 represent water, values of 0 are a non-vegetated surface, and values of 1 are areas of high levels of photosynthesizing vegetation. You can refer to individual bands in a raster stack using double brackets <code>[[]]</code></p>
<p>You can calculate the NDVI for each raster:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb16-1" tabindex="-1"></a><span class="co">#calculate NDVI pre from NIR (4th band) and Red (3rd band)</span></span>
<span id="cb16-2"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb16-2" tabindex="-1"></a>ndvi_pre <span class="ot">&lt;-</span> (pre[[<span class="dv">4</span>]]<span class="sc">-</span>pre[[<span class="dv">3</span>]])<span class="sc">/</span>(pre[[<span class="dv">4</span>]]<span class="sc">+</span>pre[[<span class="dv">3</span>]])</span>
<span id="cb16-3"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb16-3" tabindex="-1"></a><span class="co">#calculate NDVI post</span></span>
<span id="cb16-4"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb16-4" tabindex="-1"></a>ndvi_post <span class="ot">&lt;-</span> (post[[<span class="dv">4</span>]]<span class="sc">-</span>post[[<span class="dv">3</span>]])<span class="sc">/</span>(post[[<span class="dv">4</span>]]<span class="sc">+</span>post[[<span class="dv">3</span>]])</span>
<span id="cb16-5"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb16-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb16-7"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb16-7" tabindex="-1"></a><span class="fu">plot</span>(ndvi_pre)</span>
<span id="cb16-8"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb16-8" tabindex="-1"></a><span class="fu">plot</span>(ndvi_post)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>You can see the drop in NDVI after the outbreak. We can specifically calculate the difference:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb17-1" tabindex="-1"></a><span class="co"># difference between post and pre ndvi</span></span>
<span id="cb17-2"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb17-2" tabindex="-1"></a>ndviDiff <span class="ot">&lt;-</span> ndvi_post <span class="sc">-</span> ndvi_pre</span>
<span id="cb17-3"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb17-3" tabindex="-1"></a><span class="fu">plot</span>(ndviDiff)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="extract-data-in-a-vector-geometry" class="section level3 hasAnchor" number="8.5.2">
<h3><span class="header-section-number">8.5.2</span> <em>Extract data in a vector geometry</em><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#extract-data-in-a-vector-geometry" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can <strong>extract</strong> the raster values that fall within a vector geometry. The value of every pixel that overlaps with the geometry will be returned. Let’s extract the NDVI values pre and post for the two polygons. The <code>extract</code> function will pull data from out all raster cells that overlaps. When data is extracted from points, you will get a data frame. When data is extracted from lines or polygons, you get a vector stored in a <strong>list</strong> for each feature. A list is a very flexible type of object and it can store multiple items that are different R objects (for example, both a vector and data frame). Here we only have one polygon in our data frame so we can directly refer to the vector using the <code>[[1]]</code> syntax.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb18-1" tabindex="-1"></a><span class="co"># return a vector of cell values from the first polygon</span></span>
<span id="cb18-2"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb18-2" tabindex="-1"></a>ndvi_North <span class="ot">&lt;-</span> <span class="fu">extract</span>(ndviDiff,northBound)</span>
<span id="cb18-3"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb18-3" tabindex="-1"></a><span class="co"># return a vector of cell values from the first polygon</span></span>
<span id="cb18-4"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb18-4" tabindex="-1"></a>ndvi_Mid <span class="ot">&lt;-</span> <span class="fu">extract</span>(ndviDiff,midBound)</span></code></pre></div>
<p>Let’s use ggplot to visualize the data. Let’s make a data frame for the two vectors that will integrate with ggplot. You can use the <code>rep</code> function to repeat a value. Here it would be helpful to repeat the name of the boundary. The first argument is the data you want to repeat and the second argument is the number of times to repeat it:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb19-1" tabindex="-1"></a>ndviDataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">location=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;North&quot;</span>, <span class="fu">length</span>(ndvi_North[,<span class="dv">2</span>])),</span>
<span id="cb19-2"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb19-2" tabindex="-1"></a>                                       <span class="fu">rep</span>(<span class="st">&quot;Mid&quot;</span>, <span class="fu">length</span>(ndvi_Mid[,<span class="dv">2</span>]))),</span>
<span id="cb19-3"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb19-3" tabindex="-1"></a>                            <span class="at">ndvi.diff =</span><span class="fu">c</span>(ndvi_North[,<span class="dv">2</span>],ndvi_Mid[,<span class="dv">2</span>]))</span></code></pre></div>
<p>Let’s look at the change in the ndvi. We will ignore outliers here since there are occasionally numerical artifacts from calculating ndvi differences over water or the build environment:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb20-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>ndviDataframe,</span>
<span id="cb20-2"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb20-2" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x=</span>location,ndvi.diff))<span class="sc">+</span></span>
<span id="cb20-3"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb20-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb20-4"><a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#cb20-4" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>Warning: Removed 7020 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
</div>
<div id="conclusions-3" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Conclusions<a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#conclusions-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In 2021, you can see that the spongy moth defoliated much of the immediate area around Lake George. Areas in the north and the south of the lake were hit harder. A boundary of interest at the north of the lake was hit harder than a boundary near the central part of the lake.</p>
</div>
<div id="citations-4" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Citations<a href="tracking-bugs-from-space-an-introduction-to-spatial-data-in-r.html#citations-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>NYS DEC. Spongy moth. <a href="https://www.dec.ny.gov/animals/83118.html" class="uri">https://www.dec.ny.gov/animals/83118.html</a></p>
<p>Data made available by Charles Bettigole at Skidmore College.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="thirsty-crops-and-water-scarcity.-an-introduction-to-time-series.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
